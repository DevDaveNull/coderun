#!/usr/bin/env bash

# Проверка на наличие аргумента
if [ -z "$1" ]; then
  echo "Ошибка: не указан целевой окружение (staging или prod)"
  exit 1
fi

echo "Deploying to $1"

# Пример действий деплоя
# Здесь добавьте реальные шаги деплоя, например:
# 1. Копирование файлов
# 2. Перезапуск службы
# 3. Применение миграций базы данных

# Проверка успешности выполнения каждого шага
# Команды ниже приведены как примеры
if ! cp -r ./app /var/www/$1; then
  echo "Ошибка: не удалось скопировать файлы"
  exit 1
fi

if ! systemctl restart nginx; then
  echo "Ошибка: не удалось перезапустить nginx"
  exit 1
fi

# Если всё прошло успешно
echo "Деплой в окружение $1 завершен успешно"
exit 0
